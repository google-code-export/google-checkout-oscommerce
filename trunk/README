GOOGLE CHECKOUT MODULE FOR OSCOMMERCE v1.0.4 - 11/30/2006 

INTRODUCTION
============
The Google Checkout module for osCommerce adds Google Checkout as a Checkout Module within osCommerce.
This will allow merchants using osCommerce to offer Google Checkout as an alternate checkout method.
The plugin provides Level 2 integration of Google Checkout with osCommerce.

Plugin features include:
1. Posting shopping carts to Google Checkout
2. Shipping support, now you can use Merchant Calculated Shipping Rates!
3. Tax support
4. User and order updates within osCommerce
5. Order processing using osCommerce Admin UI 


REQUIREMENTS
============
osCommerce v2.2
PHP3 or PHP4 or PHP5 with cURL(libcurl) installed and enabled


INSTALLATION NOTES
==================
* Follow instructions contained in the INSTALLATION file.
* register_globals can be either On or Off. 
Verify the installation from the Admin site and selecting MODULES->PAYMENTS and checking if Google Checkout is listed as a payment option.


SETUP ON ADMIN UI
=================
Select and install the Google Checkout payment module. The following are some of the fields you can update:

1. Enable/Disable: Enable this to use Google Checkout for your site.
2. Merchant ID and Merchant Key:(Mandatory) If any of these are not set and the module is enabled, a disabled (gray) Checkout button appears on the Checkout page. 
   Set these values from your seller Google account under the Settings->Integration tab.
3. Operation Mode: Test your site with Google Checkout's sandbox server before migrating to production. You will need it signup for a separate Google Checkout sandbox account at http://sandbox.google.com/sell. Your sandbox account will have a different Merchant ID and Merchant Key. When you are ready to run against the production server, remember to update your merchant ID and key when migrating.
4. Merchant Calculation Mode of Operation: Sets Merchant calculation URL for Sandbox environment. Could be HTTP or HTTPS. (Checkout production environemnt always requires HTTPS.)
5. Default Values for Real Time Shipping Rates: Set your default values for all merchant calculated shipping rates. This values will be used if for any reason Google Checkout cannot reach your API callback to calculate the shipping price.

Your Google Checkout setup page is correct if, upon viewing it, a non-disabled Google Checkout button appears.


MERCHANT CALCULATED SHIPPING
============================
In order to use this module you must have some Real Time Shipping provider, such as USPS. This Module must be activated and configured in Modules->Shipping. For each enabled module you'll have to set the default values in the Google Checkout Admin UI.
This Value will be used if for any reason Google Checkout cannot reach your API callback to calculate the shipping price. Tha available shipping methods for each shipping provider must be configured in catalog/includes/modules/payment/googlecheckout.php in the mc_shipping_methods parameter. If you want to disable one or more methods, just comment them.
Be aware that if you mix flat rate and real time rates, both will be taken as merchant-calculated-shipping. 


TRACKING USERS AND ORDERS
=========================
In order to provide this support (as required for Level 2 integration), update the API callback request field in the seller account to https://<url-site-url>/catalog/googlecheckout/responsehandler.php . Note that the production Checkout server requires an SSL callback site.
The Sandbox server accepts non SSL callback URLs, http://<url-site-url>/catalog/googlecheckout/responsehandler.php

View your Google Checkout customers and their orders in the Reports tab. 
For each order, the default starting state is PENDING. 
The state changes to PROCESSING and DELIVERED as follows; corresponding messages will be sent out to the Checkout server for order processing.

| Original State | New State  | Action                         |  Customer Notification    |
| PENDING        | PROCESSING | charging the order             |  Processing order message |
| PROCESSING     | DELIVERED  | marking the order for delivery |  Shipped order message    |

Any comments added during state change will be sent to the buyer account page if you have selected the Notify Customer option.

All request and response messages will be logged to the file catalog/googlecheckout/response_message.log.
In case an order payment is declined or an order is cancelled(by Google or otherwise), you can add code to catalog/googlecheckout/responsehandler.php for any specific actions you need to take.


PROJECT HOME
============
To check out the latest release or to report issues, go to http://code.google.com/p/google-checkout-oscommerce


GROUP DISCUSSIONS
=================
To meet other developers and merchants who have integrated Google Checkout with osCommerce and to discuss any topics related to integration of Google Checkout with osCommerce, go to http://forums.oscommerce.com/index.php?showtopic=229637

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
MOST COMMON MISTAKES
====================
1. Make sure you set the file attribute to 777 for /googlecheckout/response_error.log and /googlecheckout/response_message.log files.
2. Set your Google callback url to https://<url-site-url>/googlecheckout/responsehandler.php
  In Sandbox, HTTPS is not required.
  In Production mode, HTTPS is required.
  Set the correct option in the Google Checkout Admin UI
3. Make sure you are using the correct combination of Merchant ID and Merchant Key. Remember that Sandbox and Production Mode have different ones.
  

TROUBLE SHOOTING
================
1. Problem: /public_html/googlecheckout/response_message.log) [function.fopen]: failed to open stream: Permission denied.
   Solution: Set the file attribute to 777 for /googlecheckout/response_error.log and /googlecheckout/response_message.log files.
2. Problem: Test order shows up in Google but not admin.
   Solution: There is an error somewhere in the file /googlecheckout/responsehandler.php or you have set a worng API callback function in your seller Google account under the Settings->Integration tab.
3. Problem: <error-message>Malformed URL component: expected id: (\d{10})|(\d{15}), but got 8***********4 </error-message>
   Solution: You have an extra space after your Google merchant id. Go to Admin->payment.  Edit Googlecheckout module.  Extra space will disappear. Click update button.
4. Problem: <error-message>No seller found with id 7************8</error-message>
   Solution: Wrong merchant id.  Sandbox merchant id can only be use with sandbox accounts.  Sandbox and Live mode use different merchant id. 
5. Problem: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderE xception: unable to find valid certification path to requested target
   Solution: Your SSL certificate is not accepted by Google Checkout.
6. Problem: <error-message>Bad Signature on Cart</error-message>
   Solution: Incorrect Merchant key.
7. Problem: (/public_html/googlecheckout/response_error.log) Tue Nov 28 8:56:21 PST 2006:- Shopping cart not obtained from session. 
   Solution: Set to False admin->configuration->session->Prevent Spider Sessions configuration (Thx dawnmariegifts, beta tester)
   Side effects: You'll see spiders as active users. Working on a permanent fix.
   
    
KNOWN BUGS - (Report bugs at http://forums.oscommerce.com/index.php?showtopic=229637)
==========


CHANGE LOG
==========
09/26/2006 v1.0.0 (Google Checkout team)
           - Initial release. 

09/27/2006 v1.0.1 (Google Checkout team)
           - Updated the original module to run on either PHP4 or PHP5.

10/05/2006 v1.0.1b (Google Checkout team)
           - Step-by-step installation instructions included.

10/18/2006 v1.0.2 (Google Checkout team)
           - Fixed minor bugs in responsehandler.php and orders.php files
  
11/17/2006 v1.0.3 (ropu)
           - Add support for Merchant Calculated Shipping Rates.
           - Fixed minor bugs in responsehandler.php and orders.php files
           - Change the XML parser and builder
           - Removed getallheader() function
           - Fixed wrong Qty in Admin UI
           - Fixed modules not saving their settings
           - Fixed Notify Customer option

11/30/2006 v1.0.4 (ropu)
           - Add state change, Risk and charge notification into the Admin UI
           - Fix Shopping cart not obtained from session. See TROUBLE SHOOTING.
